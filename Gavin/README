##DNS Command and Control Covert Channel
#By: Gavin Hunsinger
This repository includes the code and configuration files for a DNS Covert channel that allows for the DNS server to use TXT resource records to execute commands on a client device.

##Client Files
#covert_channel_service
Located in /etc/systemd/system <br/>
A systemd unit file that ensures the Python script runs at system startup with network dependencies and automatic restarts for persistence. Runs cover_execution.py.

#covert_execution.py
Located in /opt/covert_channel/<br/>
The client Python script that resolves DNS TXT records, decodes and executes commands, and sends responses, that's base64 encoded, back to server by updating a DNS Resource Record.

#resolv.conf
Located in /etc/

##Server Files
#covert_commander.py
Location /home/user <br />
A Python script allows the operator to input a command, which is base64 encoded and written into the CovertMessage2 TXT resource record using the dns module (update, query, and resolver). <br />
After the command is issued, the record is cleared to prevent accidental re-execution. The script waits 10 seconds for the client to fetch, execute, and return the result by updating the Response2 record. The server then queries Response2, decodes the output, and displays it to the user.

#named.conf.local
Located in /etc/bind/ <br />
Defines the forward and reverse lookup zones. For the forward lookup zone, it allows any host to perform dynamic updates to resource records, enabling live command injection and response retrieval.

#named.conf.options
Located in /etc/bind/ <br />
Configures core DNS server behavior including the authoritative address space, upstream forwarders, recursion settings, and a custom port for the DNS server to listen on.

#research.net
Located in /etc/bind/research/ <br />
The DNS forward lookup zone. <br />
TXT Records (Base64 Encoded): CovertMessage1 – Delivers an initial nslookup command to the client to prompt resource record resolution. CovertMessage2 – Acts as a dynamic delivery mechanism for commands sent from the server to the client. Response2 – Used by the client to send command output back to the server, encoded in base64.

#research.net.rev
Located in /etc/bind/research/ <br />
The DNS reverse lookup zone.
